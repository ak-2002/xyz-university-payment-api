2025-07-11 09:27:31.483 +03:00 [INF] Ensuring database is created
2025-07-11 09:27:34.979 +03:00 [INF] Database created successfully
2025-07-11 09:27:34.984 +03:00 [INF] Seeding default roles and permissions
2025-07-11 09:27:35.386 +03:00 [INF] Valid data already seeded, skipping seeding process
2025-07-11 09:27:35.392 +03:00 [INF] Default roles and permissions seeded successfully
2025-07-11 09:27:35.590 +03:00 [INF] XYZ University Payment API started successfully
2025-07-11 09:27:35.731 +03:00 [INF] Configured endpoint PaymentMessage, Consumer: xyz_university_payment_api.Core.Application.Services.PaymentMessageConsumer
2025-07-11 09:27:35.742 +03:00 [INF] Configured endpoint PaymentFailedMessage, Consumer: xyz_university_payment_api.Core.Application.Services.PaymentFailedMessageConsumer
2025-07-11 09:27:36.061 +03:00 [INF] Bus started: "rabbitmq://localhost/"
2025-07-11 09:28:51.865 +03:00 [INF] V3 GetStudentStats endpoint called
2025-07-11 09:28:51.873 +03:00 [INF] Current user: S67890 (ID: 50)
2025-07-11 09:28:51.881 +03:00 [INF] User roles: Student, Student
2025-07-11 09:28:51.888 +03:00 [INF] User permissions: Payments.Read, Students.Read
2025-07-11 09:28:51.895 +03:00 [INF] Retrieving all students
2025-07-11 09:28:51.962 +03:00 [INF] Retrieving payments for student: S67890
2025-07-11 09:28:52.106 +03:00 [INF] Student payments cached: S67890
2025-07-11 09:28:52.205 +03:00 [INF] Found 1 payments for student S67890, total paid: 3500.00
2025-07-11 09:28:52.294 +03:00 [INF] V3 GetStudentStats endpoint called
2025-07-11 09:28:52.303 +03:00 [INF] Current user: S67890 (ID: 50)
2025-07-11 09:28:52.315 +03:00 [INF] User roles: Student, Student
2025-07-11 09:28:52.325 +03:00 [INF] User permissions: Payments.Read, Students.Read
2025-07-11 09:28:52.336 +03:00 [INF] Retrieving all students
2025-07-11 09:28:52.410 +03:00 [INF] Retrieving payments for student: S67890
2025-07-11 09:28:52.421 +03:00 [INF] Student payments retrieved from cache: S67890
2025-07-11 09:28:52.429 +03:00 [INF] Found 1 payments for student S67890, total paid: 3500.00
2025-07-11 09:29:46.414 +03:00 [INF] V3 GetPaymentsByStudent endpoint called for student: S67890
2025-07-11 09:29:46.420 +03:00 [INF] Calling payment service for student: S67890
2025-07-11 09:29:46.427 +03:00 [INF] Retrieving payments for student: S67890
2025-07-11 09:29:46.435 +03:00 [INF] Student payments retrieved from cache: S67890
2025-07-11 09:29:46.443 +03:00 [INF] Payment service returned 1 payments for student: S67890
2025-07-11 09:29:46.450 +03:00 [INF] Payment: ID=2, Ref=REF002, Amount=3500.00, Student=S67890
2025-07-11 09:29:46.467 +03:00 [INF] AutoMapper converted to 1 DTOs
2025-07-11 09:29:46.473 +03:00 [INF] Final paged result: 1 items, Total: 1, Page: 1
2025-07-11 09:29:46.494 +03:00 [INF] V3 GetPaymentsByStudent endpoint called for student: S67890
2025-07-11 09:29:46.500 +03:00 [INF] Calling payment service for student: S67890
2025-07-11 09:29:46.506 +03:00 [INF] Retrieving payments for student: S67890
2025-07-11 09:29:46.511 +03:00 [INF] Student payments retrieved from cache: S67890
2025-07-11 09:29:46.516 +03:00 [INF] Payment service returned 1 payments for student: S67890
2025-07-11 09:29:46.523 +03:00 [INF] Payment: ID=2, Ref=REF002, Amount=3500.00, Student=S67890
2025-07-11 09:29:46.529 +03:00 [INF] AutoMapper converted to 1 DTOs
2025-07-11 09:29:46.536 +03:00 [INF] Final paged result: 1 items, Total: 1, Page: 1
2025-07-11 09:32:17.592 +03:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-07-11 09:32:17.631 +03:00 [INF] Generated access token for user admin with 1 roles and 16 permissions
2025-07-11 09:32:17.726 +03:00 [INF] V3 GetAdminStats endpoint called
2025-07-11 09:32:17.734 +03:00 [INF] Retrieving all students
2025-07-11 09:32:17.752 +03:00 [INF] Retrieving all payments
2025-07-11 09:32:17.781 +03:00 [INF] V3 GetAdminStats endpoint called
2025-07-11 09:32:17.786 +03:00 [INF] Retrieving all students
2025-07-11 09:32:17.796 +03:00 [INF] Retrieving all payments
2025-07-11 09:32:39.046 +03:00 [INF] Retrieving students V3 with filter: {"StudentNumber":null,"FullName":null,"Program":null,"IsActive":null,"CreatedFrom":null,"CreatedTo":null,"Tags":null,"MinTotalPayments":null,"MaxTotalPayments":null,"SearchTerm":null,"Metadata":null,"$type":"StudentFilterDtoV3"}
2025-07-11 09:32:39.063 +03:00 [INF] Current user role: Admin, User ID: 1
2025-07-11 09:32:39.116 +03:00 [INF] Retrieving students V3 with filter: {"StudentNumber":null,"FullName":null,"Program":null,"IsActive":null,"CreatedFrom":null,"CreatedTo":null,"Tags":null,"MinTotalPayments":null,"MaxTotalPayments":null,"SearchTerm":null,"Metadata":null,"$type":"StudentFilterDtoV3"}
2025-07-11 09:32:39.132 +03:00 [INF] Current user role: Admin, User ID: 1
2025-07-11 09:32:43.265 +03:00 [INF] Retrieving students V3 with filter: {"StudentNumber":null,"FullName":null,"Program":null,"IsActive":null,"CreatedFrom":null,"CreatedTo":null,"Tags":null,"MinTotalPayments":null,"MaxTotalPayments":null,"SearchTerm":null,"Metadata":null,"$type":"StudentFilterDtoV3"}
2025-07-11 09:32:43.278 +03:00 [INF] V3 GetAllPayments endpoint called with page 1
2025-07-11 09:32:43.295 +03:00 [INF] Current user role: Admin, User ID: 1
2025-07-11 09:32:43.301 +03:00 [INF] Retrieving all payments with student information
2025-07-11 09:32:43.316 +03:00 [INF] Current user role: Admin, User ID: 1
2025-07-11 09:32:43.326 +03:00 [INF] Retrieving students V3 with filter: {"StudentNumber":null,"FullName":null,"Program":null,"IsActive":null,"CreatedFrom":null,"CreatedTo":null,"Tags":null,"MinTotalPayments":null,"MaxTotalPayments":null,"SearchTerm":null,"Metadata":null,"$type":"StudentFilterDtoV3"}
2025-07-11 09:32:43.327 +03:00 [INF] Retrieved 6 payments for Admin
2025-07-11 09:32:43.347 +03:00 [INF] Current user role: Admin, User ID: 1
2025-07-11 09:32:43.350 +03:00 [INF] Retrieved 8 students for lookup
2025-07-11 09:32:43.358 +03:00 [INF] Payment 1 for student S12345, found student: Yes
2025-07-11 09:32:43.363 +03:00 [INF] Payment 2 for student S67890, found student: Yes
2025-07-11 09:32:43.368 +03:00 [INF] Payment 3 for student S66004, found student: Yes
2025-07-11 09:32:43.374 +03:00 [INF] Payment 4 for student S66001, found student: Yes
2025-07-11 09:32:43.379 +03:00 [INF] Payment 5 for student S660066, found student: Yes
2025-07-11 09:32:43.383 +03:00 [INF] Payment 6 for student S660088, found student: Yes
2025-07-11 09:32:43.389 +03:00 [INF] Returning 6 payment DTOs
2025-07-11 09:32:43.401 +03:00 [INF] V3 GetAllPayments endpoint called with page 1
2025-07-11 09:32:43.407 +03:00 [INF] Retrieving all payments with student information
2025-07-11 09:32:43.412 +03:00 [INF] Current user role: Admin, User ID: 1
2025-07-11 09:32:43.418 +03:00 [INF] Retrieved 6 payments for Admin
2025-07-11 09:32:43.426 +03:00 [INF] Retrieved 8 students for lookup
2025-07-11 09:32:43.431 +03:00 [INF] Payment 1 for student S12345, found student: Yes
2025-07-11 09:32:43.435 +03:00 [INF] Payment 2 for student S67890, found student: Yes
2025-07-11 09:32:43.442 +03:00 [INF] Payment 3 for student S66004, found student: Yes
2025-07-11 09:32:43.447 +03:00 [INF] Payment 4 for student S66001, found student: Yes
2025-07-11 09:32:43.451 +03:00 [INF] Payment 5 for student S660066, found student: Yes
2025-07-11 09:32:43.458 +03:00 [INF] Payment 6 for student S660088, found student: Yes
2025-07-11 09:32:43.463 +03:00 [INF] Returning 6 payment DTOs
2025-07-11 09:32:50.163 +03:00 [INF] V3 GetAllPayments endpoint called with page 1
2025-07-11 09:32:50.163 +03:00 [INF] Retrieving students V3 with filter: {"StudentNumber":null,"FullName":null,"Program":null,"IsActive":null,"CreatedFrom":null,"CreatedTo":null,"Tags":null,"MinTotalPayments":null,"MaxTotalPayments":null,"SearchTerm":null,"Metadata":null,"$type":"StudentFilterDtoV3"}
2025-07-11 09:32:50.179 +03:00 [INF] Retrieving all payments with student information
2025-07-11 09:32:50.183 +03:00 [INF] Current user role: Admin, User ID: 1
2025-07-11 09:32:50.194 +03:00 [INF] Current user role: Admin, User ID: 1
2025-07-11 09:32:50.200 +03:00 [INF] Retrieving students V3 with filter: {"StudentNumber":null,"FullName":null,"Program":null,"IsActive":null,"CreatedFrom":null,"CreatedTo":null,"Tags":null,"MinTotalPayments":null,"MaxTotalPayments":null,"SearchTerm":null,"Metadata":null,"$type":"StudentFilterDtoV3"}
2025-07-11 09:32:50.202 +03:00 [INF] Retrieved 6 payments for Admin
2025-07-11 09:32:50.218 +03:00 [INF] Current user role: Admin, User ID: 1
2025-07-11 09:32:50.223 +03:00 [INF] Retrieved 8 students for lookup
2025-07-11 09:32:50.230 +03:00 [INF] Payment 1 for student S12345, found student: Yes
2025-07-11 09:32:50.235 +03:00 [INF] Payment 2 for student S67890, found student: Yes
2025-07-11 09:32:50.242 +03:00 [INF] Payment 3 for student S66004, found student: Yes
2025-07-11 09:32:50.247 +03:00 [INF] Payment 4 for student S66001, found student: Yes
2025-07-11 09:32:50.253 +03:00 [INF] Payment 5 for student S660066, found student: Yes
2025-07-11 09:32:50.259 +03:00 [INF] Payment 6 for student S660088, found student: Yes
2025-07-11 09:32:50.264 +03:00 [INF] Returning 6 payment DTOs
2025-07-11 09:32:50.271 +03:00 [INF] V3 GetAllPayments endpoint called with page 1
2025-07-11 09:32:50.276 +03:00 [INF] Retrieving all payments with student information
2025-07-11 09:32:50.281 +03:00 [INF] Current user role: Admin, User ID: 1
2025-07-11 09:32:50.289 +03:00 [INF] Retrieved 6 payments for Admin
2025-07-11 09:32:50.296 +03:00 [INF] Retrieved 8 students for lookup
2025-07-11 09:32:50.300 +03:00 [INF] Payment 1 for student S12345, found student: Yes
2025-07-11 09:32:50.308 +03:00 [INF] Payment 2 for student S67890, found student: Yes
2025-07-11 09:32:50.313 +03:00 [INF] Payment 3 for student S66004, found student: Yes
2025-07-11 09:32:50.317 +03:00 [INF] Payment 4 for student S66001, found student: Yes
2025-07-11 09:32:50.323 +03:00 [INF] Payment 5 for student S660066, found student: Yes
2025-07-11 09:32:50.329 +03:00 [INF] Payment 6 for student S660088, found student: Yes
2025-07-11 09:32:50.334 +03:00 [INF] Returning 6 payment DTOs
2025-07-11 09:32:59.595 +03:00 [INF] V3 GetAllPayments endpoint called with page 1
2025-07-11 09:32:59.603 +03:00 [INF] Retrieving all payments with student information
2025-07-11 09:32:59.611 +03:00 [INF] Current user role: Admin, User ID: 1
2025-07-11 09:32:59.615 +03:00 [INF] Retrieving students V3 with filter: {"StudentNumber":null,"FullName":null,"Program":null,"IsActive":null,"CreatedFrom":null,"CreatedTo":null,"Tags":null,"MinTotalPayments":null,"MaxTotalPayments":null,"SearchTerm":null,"Metadata":null,"$type":"StudentFilterDtoV3"}
2025-07-11 09:32:59.639 +03:00 [INF] Retrieved 6 payments for Admin
2025-07-11 09:32:59.645 +03:00 [INF] Current user role: Admin, User ID: 1
2025-07-11 09:32:59.657 +03:00 [INF] Retrieved 8 students for lookup
2025-07-11 09:32:59.664 +03:00 [INF] Payment 1 for student S12345, found student: Yes
2025-07-11 09:32:59.671 +03:00 [INF] Payment 2 for student S67890, found student: Yes
2025-07-11 09:32:59.677 +03:00 [INF] Retrieving students V3 with filter: {"StudentNumber":null,"FullName":null,"Program":null,"IsActive":null,"CreatedFrom":null,"CreatedTo":null,"Tags":null,"MinTotalPayments":null,"MaxTotalPayments":null,"SearchTerm":null,"Metadata":null,"$type":"StudentFilterDtoV3"}
2025-07-11 09:32:59.689 +03:00 [INF] Payment 3 for student S66004, found student: Yes
2025-07-11 09:32:59.695 +03:00 [INF] Current user role: Admin, User ID: 1
2025-07-11 09:32:59.704 +03:00 [INF] Payment 4 for student S66001, found student: Yes
2025-07-11 09:32:59.711 +03:00 [INF] Payment 5 for student S660066, found student: Yes
2025-07-11 09:32:59.716 +03:00 [INF] Payment 6 for student S660088, found student: Yes
2025-07-11 09:32:59.721 +03:00 [INF] Returning 6 payment DTOs
2025-07-11 09:32:59.728 +03:00 [INF] V3 GetAllPayments endpoint called with page 1
2025-07-11 09:32:59.732 +03:00 [INF] Retrieving all payments with student information
2025-07-11 09:32:59.737 +03:00 [INF] Current user role: Admin, User ID: 1
2025-07-11 09:32:59.743 +03:00 [INF] Retrieved 6 payments for Admin
2025-07-11 09:32:59.749 +03:00 [INF] Retrieved 8 students for lookup
2025-07-11 09:32:59.754 +03:00 [INF] Payment 1 for student S12345, found student: Yes
2025-07-11 09:32:59.759 +03:00 [INF] Payment 2 for student S67890, found student: Yes
2025-07-11 09:32:59.763 +03:00 [INF] Payment 3 for student S66004, found student: Yes
2025-07-11 09:32:59.768 +03:00 [INF] Payment 4 for student S66001, found student: Yes
2025-07-11 09:32:59.774 +03:00 [INF] Payment 5 for student S660066, found student: Yes
2025-07-11 09:32:59.778 +03:00 [INF] Payment 6 for student S660088, found student: Yes
2025-07-11 09:32:59.783 +03:00 [INF] Returning 6 payment DTOs
2025-07-11 09:33:01.799 +03:00 [INF] GetUsers endpoint called by user: admin
2025-07-11 09:33:01.817 +03:00 [INF] Total users in database: 11
2025-07-11 09:33:01.860 +03:00 [INF] Returning 11 users
2025-07-11 09:33:01.877 +03:00 [INF] GetUsers endpoint called by user: admin
2025-07-11 09:33:01.883 +03:00 [INF] Total users in database: 11
2025-07-11 09:33:01.890 +03:00 [INF] Returning 11 users
2025-07-11 09:33:16.398 +03:00 [INF] GetUsers endpoint called by user: admin
2025-07-11 09:33:16.398 +03:00 [INF] GetUsers endpoint called by user: admin
2025-07-11 09:33:16.411 +03:00 [INF] Total users in database: 11
2025-07-11 09:33:16.412 +03:00 [INF] Total users in database: 11
2025-07-11 09:33:16.429 +03:00 [INF] Returning 11 users
2025-07-11 09:33:16.429 +03:00 [INF] Returning 11 users
2025-07-11 09:33:23.617 +03:00 [INF] Assigning role to user 48. RoleName: 'Student' (Length: 7)
2025-07-11 09:33:23.676 +03:00 [WRN] The query uses the 'First'/'FirstOrDefault' operator without 'OrderBy' and filter operators. This may lead to unpredictable results.
2025-07-11 09:33:23.696 +03:00 [ERR] Failed executing DbCommand (4ms) [Parameters=[p0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [x].[Id], [x].[CreatedAt], [x].[Description], [x].[IsActive], [x].[Name]
FROM (
    SELECT Id FROM Roles WHERE Name = @p0
) AS [x]
2025-07-11 09:33:23.726 +03:00 [ERR] An exception occurred while iterating over the results of a query for context type 'xyz_university_payment_api.Infrastructure.Data.AppDbContext'.
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'CreatedAt'.
Invalid column name 'Description'.
Invalid column name 'IsActive'.
Invalid column name 'Name'.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:a21105d6-fb7a-40f9-871f-a43f9e71eaf4
Error Number:207,State:1,Class:16
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'CreatedAt'.
Invalid column name 'Description'.
Invalid column name 'IsActive'.
Invalid column name 'Name'.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
ClientConnectionId:a21105d6-fb7a-40f9-871f-a43f9e71eaf4
Error Number:207,State:1,Class:16
2025-07-11 09:33:23.746 +03:00 [ERR] Error assigning role to user 48
Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'CreatedAt'.
Invalid column name 'Description'.
Invalid column name 'IsActive'.
Invalid column name 'Name'.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3.AssignRole(Int32 id, AssignRoleDto assignRoleDto) in C:\Users\wanja\Desktop\jj\xyz-university-payment-api\xyz-university-payment-api\Presentation\Controllers\V3\UserControllerV3.cs:line 240
   at xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3.AssignRole(Int32 id, AssignRoleDto assignRoleDto) in C:\Users\wanja\Desktop\jj\xyz-university-payment-api\xyz-university-payment-api\Presentation\Controllers\V3\UserControllerV3.cs:line 261
ClientConnectionId:a21105d6-fb7a-40f9-871f-a43f9e71eaf4
Error Number:207,State:1,Class:16
2025-07-11 09:35:36.659 +03:00 [INF] Generated access token for user S660066 with 0 roles and 0 permissions
2025-07-11 09:37:46.253 +03:00 [INF] Generated access token for user admin with 1 roles and 16 permissions
2025-07-11 09:37:46.295 +03:00 [INF] V3 GetAdminStats endpoint called
2025-07-11 09:37:46.313 +03:00 [INF] Retrieving all students
2025-07-11 09:37:46.330 +03:00 [INF] Retrieving all payments
2025-07-11 09:37:46.347 +03:00 [INF] V3 GetAdminStats endpoint called
2025-07-11 09:37:46.359 +03:00 [INF] Retrieving all students
2025-07-11 09:37:46.366 +03:00 [INF] Retrieving all payments
2025-07-11 09:37:50.934 +03:00 [INF] GetUsers endpoint called by user: admin
2025-07-11 09:37:50.947 +03:00 [INF] Total users in database: 11
2025-07-11 09:37:50.968 +03:00 [INF] Returning 11 users
2025-07-11 09:37:50.980 +03:00 [INF] GetUsers endpoint called by user: admin
2025-07-11 09:37:50.987 +03:00 [INF] Total users in database: 11
2025-07-11 09:37:50.994 +03:00 [INF] Returning 11 users
2025-07-11 09:38:15.833 +03:00 [INF] Retrieving students V3 with filter: {"StudentNumber":null,"FullName":null,"Program":null,"IsActive":null,"CreatedFrom":null,"CreatedTo":null,"Tags":null,"MinTotalPayments":null,"MaxTotalPayments":null,"SearchTerm":null,"Metadata":null,"$type":"StudentFilterDtoV3"}
2025-07-11 09:38:15.856 +03:00 [INF] Current user role: Admin, User ID: 1
2025-07-11 09:38:15.875 +03:00 [INF] Retrieving students V3 with filter: {"StudentNumber":null,"FullName":null,"Program":null,"IsActive":null,"CreatedFrom":null,"CreatedTo":null,"Tags":null,"MinTotalPayments":null,"MaxTotalPayments":null,"SearchTerm":null,"Metadata":null,"$type":"StudentFilterDtoV3"}
2025-07-11 09:38:15.894 +03:00 [INF] Current user role: Admin, User ID: 1
2025-07-11 09:38:22.648 +03:00 [INF] Deleting student V3 with ID: 8, Permanent: false
2025-07-11 09:38:22.657 +03:00 [INF] Deleting student with ID: 8, Force: false
2025-07-11 09:38:22.674 +03:00 [WRN] Cannot delete active student: S660066. Use force=true to override.
2025-07-11 09:38:22.679 +03:00 [ERR] Error deleting student with ID: 8
System.InvalidOperationException: Cannot delete active student S660066. Use force=true to override.
   at xyz_university_payment_api.Core.Application.Services.StudentService.DeleteStudentAsync(Int32 id, Boolean force) in C:\Users\wanja\Desktop\jj\xyz-university-payment-api\xyz-university-payment-api\Core\Application\Services\StudentService.cs:line 227
2025-07-11 09:38:22.688 +03:00 [ERR] Error deleting student V3 with ID: 8
xyz_university_payment_api.Core.Domain.Exceptions.DatabaseException: Database operation failed: Failed to delete student with ID 8
 ---> System.InvalidOperationException: Cannot delete active student S660066. Use force=true to override.
   at xyz_university_payment_api.Core.Application.Services.StudentService.DeleteStudentAsync(Int32 id, Boolean force) in C:\Users\wanja\Desktop\jj\xyz-university-payment-api\xyz-university-payment-api\Core\Application\Services\StudentService.cs:line 227
   --- End of inner exception stack trace ---
   at xyz_university_payment_api.Core.Application.Services.StudentService.DeleteStudentAsync(Int32 id, Boolean force) in C:\Users\wanja\Desktop\jj\xyz-university-payment-api\xyz-university-payment-api\Core\Application\Services\StudentService.cs:line 237
   at xyz_university_payment_api.Core.Application.Services.StudentService.DeleteStudentV3Async(Int32 id, Boolean permanent) in C:\Users\wanja\Desktop\jj\xyz-university-payment-api\xyz-university-payment-api\Core\Application\Services\StudentService.cs:line 839
2025-07-11 09:38:22.704 +03:00 [INF] Retrieving students V3 with filter: {"StudentNumber":null,"FullName":null,"Program":null,"IsActive":null,"CreatedFrom":null,"CreatedTo":null,"Tags":null,"MinTotalPayments":null,"MaxTotalPayments":null,"SearchTerm":null,"Metadata":null,"$type":"StudentFilterDtoV3"}
2025-07-11 09:38:22.717 +03:00 [INF] Current user role: Admin, User ID: 1
2025-07-11 09:38:57.194 +03:00 [INF] Deleting student V3 with ID: 8, Permanent: false
2025-07-11 09:38:57.202 +03:00 [INF] Deleting student with ID: 8, Force: false
2025-07-11 09:38:57.222 +03:00 [WRN] Cannot delete active student: S660066. Use force=true to override.
2025-07-11 09:38:57.230 +03:00 [ERR] Error deleting student with ID: 8
System.InvalidOperationException: Cannot delete active student S660066. Use force=true to override.
   at xyz_university_payment_api.Core.Application.Services.StudentService.DeleteStudentAsync(Int32 id, Boolean force) in C:\Users\wanja\Desktop\jj\xyz-university-payment-api\xyz-university-payment-api\Core\Application\Services\StudentService.cs:line 227
2025-07-11 09:38:57.240 +03:00 [ERR] Error deleting student V3 with ID: 8
xyz_university_payment_api.Core.Domain.Exceptions.DatabaseException: Database operation failed: Failed to delete student with ID 8
 ---> System.InvalidOperationException: Cannot delete active student S660066. Use force=true to override.
   at xyz_university_payment_api.Core.Application.Services.StudentService.DeleteStudentAsync(Int32 id, Boolean force) in C:\Users\wanja\Desktop\jj\xyz-university-payment-api\xyz-university-payment-api\Core\Application\Services\StudentService.cs:line 227
   --- End of inner exception stack trace ---
   at xyz_university_payment_api.Core.Application.Services.StudentService.DeleteStudentAsync(Int32 id, Boolean force) in C:\Users\wanja\Desktop\jj\xyz-university-payment-api\xyz-university-payment-api\Core\Application\Services\StudentService.cs:line 237
   at xyz_university_payment_api.Core.Application.Services.StudentService.DeleteStudentV3Async(Int32 id, Boolean permanent) in C:\Users\wanja\Desktop\jj\xyz-university-payment-api\xyz-university-payment-api\Core\Application\Services\StudentService.cs:line 839
2025-07-11 09:38:57.256 +03:00 [INF] Retrieving students V3 with filter: {"StudentNumber":null,"FullName":null,"Program":null,"IsActive":null,"CreatedFrom":null,"CreatedTo":null,"Tags":null,"MinTotalPayments":null,"MaxTotalPayments":null,"SearchTerm":null,"Metadata":null,"$type":"StudentFilterDtoV3"}
2025-07-11 09:38:57.269 +03:00 [INF] Current user role: Admin, User ID: 1
2025-07-11 09:52:58.340 +03:00 [INF] Bus stopped: "rabbitmq://localhost/"
2025-07-11 09:53:23.305 +03:00 [INF] Starting XYZ University Payment API {"MachineName":"DESKTOP-F3AMJ10","ThreadId":1,"ProcessId":5072,"Application":"XYZ University Payment API"}
