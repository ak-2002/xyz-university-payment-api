2025-07-10 11:52:40.506 +03:00 [INF] Ensuring database is created {"MachineName":"DESKTOP-F3AMJ10","ThreadId":1,"ProcessId":8380,"Application":"XYZ University Payment API"}
2025-07-10 11:52:41.051 +03:00 [INF] Database created successfully {"MachineName":"DESKTOP-F3AMJ10","ThreadId":1,"ProcessId":8380,"Application":"XYZ University Payment API"}
2025-07-10 11:52:41.054 +03:00 [INF] Seeding default roles and permissions {"MachineName":"DESKTOP-F3AMJ10","ThreadId":1,"ProcessId":8380,"Application":"XYZ University Payment API"}
2025-07-10 11:52:41.346 +03:00 [INF] Valid data already seeded, skipping seeding process {"SourceContext":"xyz_university_payment_api.Core.Application.Services.AuthorizationService","MachineName":"DESKTOP-F3AMJ10","ThreadId":9,"ProcessId":8380,"Application":"XYZ University Payment API"}
2025-07-10 11:52:41.368 +03:00 [INF] Default roles and permissions seeded successfully {"MachineName":"DESKTOP-F3AMJ10","ThreadId":9,"ProcessId":8380,"Application":"XYZ University Payment API"}
2025-07-10 11:52:41.526 +03:00 [INF] XYZ University Payment API started successfully {"MachineName":"DESKTOP-F3AMJ10","ThreadId":9,"ProcessId":8380,"Application":"XYZ University Payment API"}
2025-07-10 11:52:41.641 +03:00 [INF] Configured endpoint PaymentProcessedMessage, Consumer: xyz_university_payment_api.Core.Application.Services.PaymentProcessedMessageConsumer {"SourceContext":"MassTransit","MachineName":"DESKTOP-F3AMJ10","ThreadId":9,"ProcessId":8380,"Application":"XYZ University Payment API"}
2025-07-10 11:52:41.651 +03:00 [INF] Configured endpoint PaymentFailedMessage, Consumer: xyz_university_payment_api.Core.Application.Services.PaymentFailedMessageConsumer {"SourceContext":"MassTransit","MachineName":"DESKTOP-F3AMJ10","ThreadId":9,"ProcessId":8380,"Application":"XYZ University Payment API"}
2025-07-10 11:52:41.658 +03:00 [INF] Configured endpoint PaymentValidationMessage, Consumer: xyz_university_payment_api.Core.Application.Services.PaymentValidationMessageConsumer {"SourceContext":"MassTransit","MachineName":"DESKTOP-F3AMJ10","ThreadId":9,"ProcessId":8380,"Application":"XYZ University Payment API"}
2025-07-10 11:52:41.963 +03:00 [INF] Bus started: "rabbitmq://localhost/" {"SourceContext":"MassTransit","MachineName":"DESKTOP-F3AMJ10","ThreadId":18,"ProcessId":8380,"Application":"XYZ University Payment API"}
2025-07-10 11:52:54.729 +03:00 [INF] Retrieving students V3 with filter: {"StudentNumber":null,"FullName":null,"Program":null,"IsActive":null,"CreatedFrom":null,"CreatedTo":null,"Tags":null,"MinTotalPayments":null,"MaxTotalPayments":null,"SearchTerm":null,"Metadata":null,"$type":"StudentFilterDtoV3"} {"SourceContext":"xyz_university_payment_api.Core.Application.Services.StudentService","ActionId":"1ab1f8a3-8fbe-4fab-9751-11d5381d94df","ActionName":"xyz_university_payment_api.Presentation.Controllers.V3.StudentControllerV3.GetStudents (xyz-university-payment-api)","RequestId":"0HNDVHSKE3KHI:00000002","RequestPath":"/api/v3/StudentControllerV","ConnectionId":"0HNDVHSKE3KHI","MachineName":"DESKTOP-F3AMJ10","ThreadId":6,"ProcessId":8380,"Application":"XYZ University Payment API"}
2025-07-10 11:52:54.779 +03:00 [INF] Current user role: Admin, User ID: 1 {"SourceContext":"xyz_university_payment_api.Core.Application.Services.StudentService","ActionId":"1ab1f8a3-8fbe-4fab-9751-11d5381d94df","ActionName":"xyz_university_payment_api.Presentation.Controllers.V3.StudentControllerV3.GetStudents (xyz-university-payment-api)","RequestId":"0HNDVHSKE3KHI:00000002","RequestPath":"/api/v3/StudentControllerV","ConnectionId":"0HNDVHSKE3KHI","MachineName":"DESKTOP-F3AMJ10","ThreadId":6,"ProcessId":8380,"Application":"XYZ University Payment API"}
2025-07-10 11:52:54.947 +03:00 [INF] Retrieving students V3 with filter: {"StudentNumber":null,"FullName":null,"Program":null,"IsActive":null,"CreatedFrom":null,"CreatedTo":null,"Tags":null,"MinTotalPayments":null,"MaxTotalPayments":null,"SearchTerm":null,"Metadata":null,"$type":"StudentFilterDtoV3"} {"SourceContext":"xyz_university_payment_api.Core.Application.Services.StudentService","ActionId":"1ab1f8a3-8fbe-4fab-9751-11d5381d94df","ActionName":"xyz_university_payment_api.Presentation.Controllers.V3.StudentControllerV3.GetStudents (xyz-university-payment-api)","RequestId":"0HNDVHSKE3KHH:00000002","RequestPath":"/api/v3/StudentControllerV","ConnectionId":"0HNDVHSKE3KHH","MachineName":"DESKTOP-F3AMJ10","ThreadId":6,"ProcessId":8380,"Application":"XYZ University Payment API"}
2025-07-10 11:52:55.017 +03:00 [INF] Current user role: Admin, User ID: 1 {"SourceContext":"xyz_university_payment_api.Core.Application.Services.StudentService","ActionId":"1ab1f8a3-8fbe-4fab-9751-11d5381d94df","ActionName":"xyz_university_payment_api.Presentation.Controllers.V3.StudentControllerV3.GetStudents (xyz-university-payment-api)","RequestId":"0HNDVHSKE3KHH:00000002","RequestPath":"/api/v3/StudentControllerV","ConnectionId":"0HNDVHSKE3KHH","MachineName":"DESKTOP-F3AMJ10","ThreadId":6,"ProcessId":8380,"Application":"XYZ University Payment API"}
2025-07-10 11:53:00.877 +03:00 [INF] GetUsers endpoint called by user: admin {"SourceContext":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3","ActionId":"a46ba65c-2844-457a-8151-8be792b02ee4","ActionName":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3.GetUsers (xyz-university-payment-api)","RequestId":"0HNDVHSKE3KHK:00000002","RequestPath":"/api/v3/user/users","ConnectionId":"0HNDVHSKE3KHK","MachineName":"DESKTOP-F3AMJ10","ThreadId":18,"ProcessId":8380,"Application":"XYZ University Payment API"}
2025-07-10 11:53:00.878 +03:00 [INF] GetUsers endpoint called by user: admin {"SourceContext":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3","ActionId":"a46ba65c-2844-457a-8151-8be792b02ee4","ActionName":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3.GetUsers (xyz-university-payment-api)","RequestId":"0HNDVHSKE3KHJ:00000002","RequestPath":"/api/v3/user/users","ConnectionId":"0HNDVHSKE3KHJ","MachineName":"DESKTOP-F3AMJ10","ThreadId":14,"ProcessId":8380,"Application":"XYZ University Payment API"}
2025-07-10 11:53:00.972 +03:00 [INF] Total users in database: 6 {"SourceContext":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3","ActionId":"a46ba65c-2844-457a-8151-8be792b02ee4","ActionName":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3.GetUsers (xyz-university-payment-api)","RequestId":"0HNDVHSKE3KHJ:00000002","RequestPath":"/api/v3/user/users","ConnectionId":"0HNDVHSKE3KHJ","MachineName":"DESKTOP-F3AMJ10","ThreadId":18,"ProcessId":8380,"Application":"XYZ University Payment API"}
2025-07-10 11:53:00.983 +03:00 [INF] Total users in database: 6 {"SourceContext":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3","ActionId":"a46ba65c-2844-457a-8151-8be792b02ee4","ActionName":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3.GetUsers (xyz-university-payment-api)","RequestId":"0HNDVHSKE3KHK:00000002","RequestPath":"/api/v3/user/users","ConnectionId":"0HNDVHSKE3KHK","MachineName":"DESKTOP-F3AMJ10","ThreadId":14,"ProcessId":8380,"Application":"XYZ University Payment API"}
2025-07-10 11:53:01.119 +03:00 [INF] Returning 6 users {"SourceContext":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3","ActionId":"a46ba65c-2844-457a-8151-8be792b02ee4","ActionName":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3.GetUsers (xyz-university-payment-api)","RequestId":"0HNDVHSKE3KHK:00000002","RequestPath":"/api/v3/user/users","ConnectionId":"0HNDVHSKE3KHK","MachineName":"DESKTOP-F3AMJ10","ThreadId":14,"ProcessId":8380,"Application":"XYZ University Payment API"}
2025-07-10 11:53:01.119 +03:00 [INF] Returning 6 users {"SourceContext":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3","ActionId":"a46ba65c-2844-457a-8151-8be792b02ee4","ActionName":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3.GetUsers (xyz-university-payment-api)","RequestId":"0HNDVHSKE3KHJ:00000002","RequestPath":"/api/v3/user/users","ConnectionId":"0HNDVHSKE3KHJ","MachineName":"DESKTOP-F3AMJ10","ThreadId":18,"ProcessId":8380,"Application":"XYZ University Payment API"}
2025-07-10 11:53:09.979 +03:00 [INF] Retrieving students V3 with filter: {"StudentNumber":null,"FullName":null,"Program":null,"IsActive":null,"CreatedFrom":null,"CreatedTo":null,"Tags":null,"MinTotalPayments":null,"MaxTotalPayments":null,"SearchTerm":null,"Metadata":null,"$type":"StudentFilterDtoV3"} {"SourceContext":"xyz_university_payment_api.Core.Application.Services.StudentService","ActionId":"1ab1f8a3-8fbe-4fab-9751-11d5381d94df","ActionName":"xyz_university_payment_api.Presentation.Controllers.V3.StudentControllerV3.GetStudents (xyz-university-payment-api)","RequestId":"0HNDVHSKE3KHL:00000002","RequestPath":"/api/v3/StudentControllerV","ConnectionId":"0HNDVHSKE3KHL","MachineName":"DESKTOP-F3AMJ10","ThreadId":18,"ProcessId":8380,"Application":"XYZ University Payment API"}
2025-07-10 11:53:10.005 +03:00 [INF] Current user role: Admin, User ID: 1 {"SourceContext":"xyz_university_payment_api.Core.Application.Services.StudentService","ActionId":"1ab1f8a3-8fbe-4fab-9751-11d5381d94df","ActionName":"xyz_university_payment_api.Presentation.Controllers.V3.StudentControllerV3.GetStudents (xyz-university-payment-api)","RequestId":"0HNDVHSKE3KHL:00000002","RequestPath":"/api/v3/StudentControllerV","ConnectionId":"0HNDVHSKE3KHL","MachineName":"DESKTOP-F3AMJ10","ThreadId":18,"ProcessId":8380,"Application":"XYZ University Payment API"}
2025-07-10 11:53:28.496 +03:00 [INF] Creating user with username: S12345, email: S12345@xyz.edu, defaultRole: Student {"SourceContext":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3","ActionId":"3b001058-cc81-480f-925c-97653e0774e4","ActionName":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3.CreateUser (xyz-university-payment-api)","RequestId":"0HNDVHSKE3KHM:00000002","RequestPath":"/api/v3/user/users","ConnectionId":"0HNDVHSKE3KHM","MachineName":"DESKTOP-F3AMJ10","ThreadId":6,"ProcessId":8380,"Application":"XYZ University Payment API"}
2025-07-10 11:53:28.593 +03:00 [INF] User created with ID: 44 {"SourceContext":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3","ActionId":"3b001058-cc81-480f-925c-97653e0774e4","ActionName":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3.CreateUser (xyz-university-payment-api)","RequestId":"0HNDVHSKE3KHM:00000002","RequestPath":"/api/v3/user/users","ConnectionId":"0HNDVHSKE3KHM","MachineName":"DESKTOP-F3AMJ10","ThreadId":6,"ProcessId":8380,"Application":"XYZ University Payment API"}
2025-07-10 11:53:28.600 +03:00 [INF] Looking for role: Student {"SourceContext":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3","ActionId":"3b001058-cc81-480f-925c-97653e0774e4","ActionName":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3.CreateUser (xyz-university-payment-api)","RequestId":"0HNDVHSKE3KHM:00000002","RequestPath":"/api/v3/user/users","ConnectionId":"0HNDVHSKE3KHM","MachineName":"DESKTOP-F3AMJ10","ThreadId":6,"ProcessId":8380,"Application":"XYZ University Payment API"}
2025-07-10 11:53:28.609 +03:00 [INF] Available roles in database: Admin, Manager, Staff, Student {"SourceContext":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3","ActionId":"3b001058-cc81-480f-925c-97653e0774e4","ActionName":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3.CreateUser (xyz-university-payment-api)","RequestId":"0HNDVHSKE3KHM:00000002","RequestPath":"/api/v3/user/users","ConnectionId":"0HNDVHSKE3KHM","MachineName":"DESKTOP-F3AMJ10","ThreadId":6,"ProcessId":8380,"Application":"XYZ University Payment API"}
2025-07-10 11:53:28.619 +03:00 [INF] Found role Student with ID 4 {"SourceContext":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3","ActionId":"3b001058-cc81-480f-925c-97653e0774e4","ActionName":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3.CreateUser (xyz-university-payment-api)","RequestId":"0HNDVHSKE3KHM:00000002","RequestPath":"/api/v3/user/users","ConnectionId":"0HNDVHSKE3KHM","MachineName":"DESKTOP-F3AMJ10","ThreadId":6,"ProcessId":8380,"Application":"XYZ University Payment API"}
2025-07-10 11:53:28.678 +03:00 [INF] Role Student assigned to user 44 {"SourceContext":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3","ActionId":"3b001058-cc81-480f-925c-97653e0774e4","ActionName":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3.CreateUser (xyz-university-payment-api)","RequestId":"0HNDVHSKE3KHM:00000002","RequestPath":"/api/v3/user/users","ConnectionId":"0HNDVHSKE3KHM","MachineName":"DESKTOP-F3AMJ10","ThreadId":6,"ProcessId":8380,"Application":"XYZ University Payment API"}
2025-07-10 11:53:28.697 +03:00 [INF] Creating user for existing student 1 - John Doe {"SourceContext":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3","ActionId":"3b001058-cc81-480f-925c-97653e0774e4","ActionName":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3.CreateUser (xyz-university-payment-api)","RequestId":"0HNDVHSKE3KHM:00000002","RequestPath":"/api/v3/user/users","ConnectionId":"0HNDVHSKE3KHM","MachineName":"DESKTOP-F3AMJ10","ThreadId":6,"ProcessId":8380,"Application":"XYZ University Payment API"}
2025-07-10 11:53:28.708 +03:00 [WRN] User already exists for student S12345 {"SourceContext":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3","ActionId":"3b001058-cc81-480f-925c-97653e0774e4","ActionName":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3.CreateUser (xyz-university-payment-api)","RequestId":"0HNDVHSKE3KHM:00000002","RequestPath":"/api/v3/user/users","ConnectionId":"0HNDVHSKE3KHM","MachineName":"DESKTOP-F3AMJ10","ThreadId":6,"ProcessId":8380,"Application":"XYZ University Payment API"}
2025-07-10 11:53:37.664 +03:00 [INF] Creating user with username: S12345, email: S12345@xyz.edu, defaultRole: Student {"SourceContext":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3","ActionId":"3b001058-cc81-480f-925c-97653e0774e4","ActionName":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3.CreateUser (xyz-university-payment-api)","RequestId":"0HNDVHSKE3KHN:00000002","RequestPath":"/api/v3/user/users","ConnectionId":"0HNDVHSKE3KHN","MachineName":"DESKTOP-F3AMJ10","ThreadId":18,"ProcessId":8380,"Application":"XYZ University Payment API"}
2025-07-10 11:53:37.674 +03:00 [WRN] Username S12345 already exists {"SourceContext":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3","ActionId":"3b001058-cc81-480f-925c-97653e0774e4","ActionName":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3.CreateUser (xyz-university-payment-api)","RequestId":"0HNDVHSKE3KHN:00000002","RequestPath":"/api/v3/user/users","ConnectionId":"0HNDVHSKE3KHN","MachineName":"DESKTOP-F3AMJ10","ThreadId":18,"ProcessId":8380,"Application":"XYZ University Payment API"}
2025-07-10 11:54:53.916 +03:00 [INF] Creating user with username: S66002, email: S66002@xyz.edu, defaultRole: Student {"SourceContext":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3","ActionId":"3b001058-cc81-480f-925c-97653e0774e4","ActionName":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3.CreateUser (xyz-university-payment-api)","RequestId":"0HNDVHSKE3KHO:00000002","RequestPath":"/api/v3/user/users","ConnectionId":"0HNDVHSKE3KHO","MachineName":"DESKTOP-F3AMJ10","ThreadId":6,"ProcessId":8380,"Application":"XYZ University Payment API"}
2025-07-10 11:54:53.936 +03:00 [INF] User created with ID: 46 {"SourceContext":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3","ActionId":"3b001058-cc81-480f-925c-97653e0774e4","ActionName":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3.CreateUser (xyz-university-payment-api)","RequestId":"0HNDVHSKE3KHO:00000002","RequestPath":"/api/v3/user/users","ConnectionId":"0HNDVHSKE3KHO","MachineName":"DESKTOP-F3AMJ10","ThreadId":6,"ProcessId":8380,"Application":"XYZ University Payment API"}
2025-07-10 11:54:53.941 +03:00 [INF] Looking for role: Student {"SourceContext":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3","ActionId":"3b001058-cc81-480f-925c-97653e0774e4","ActionName":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3.CreateUser (xyz-university-payment-api)","RequestId":"0HNDVHSKE3KHO:00000002","RequestPath":"/api/v3/user/users","ConnectionId":"0HNDVHSKE3KHO","MachineName":"DESKTOP-F3AMJ10","ThreadId":6,"ProcessId":8380,"Application":"XYZ University Payment API"}
2025-07-10 11:54:53.947 +03:00 [INF] Available roles in database: Admin, Manager, Staff, Student,  {"SourceContext":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3","ActionId":"3b001058-cc81-480f-925c-97653e0774e4","ActionName":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3.CreateUser (xyz-university-payment-api)","RequestId":"0HNDVHSKE3KHO:00000002","RequestPath":"/api/v3/user/users","ConnectionId":"0HNDVHSKE3KHO","MachineName":"DESKTOP-F3AMJ10","ThreadId":6,"ProcessId":8380,"Application":"XYZ University Payment API"}
2025-07-10 11:54:53.953 +03:00 [INF] Found role Student with ID 4 {"SourceContext":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3","ActionId":"3b001058-cc81-480f-925c-97653e0774e4","ActionName":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3.CreateUser (xyz-university-payment-api)","RequestId":"0HNDVHSKE3KHO:00000002","RequestPath":"/api/v3/user/users","ConnectionId":"0HNDVHSKE3KHO","MachineName":"DESKTOP-F3AMJ10","ThreadId":6,"ProcessId":8380,"Application":"XYZ University Payment API"}
2025-07-10 11:54:53.986 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'xyz_university_payment_api.Infrastructure.Data.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert duplicate key row in object 'dbo.Roles' with unique index 'IX_Roles_Name'. The duplicate key value is ().
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:f6af4d95-f7f4-490b-bd91-2e4e366b5cfe
Error Number:2601,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken) {"EventId":{"Id":10000,"Name":"Microsoft.EntityFrameworkCore.Update.SaveChangesFailed"},"SourceContext":"Microsoft.EntityFrameworkCore.Update","ActionId":"3b001058-cc81-480f-925c-97653e0774e4","ActionName":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3.CreateUser (xyz-university-payment-api)","RequestId":"0HNDVHSKE3KHO:00000002","RequestPath":"/api/v3/user/users","ConnectionId":"0HNDVHSKE3KHO","MachineName":"DESKTOP-F3AMJ10","ThreadId":6,"ProcessId":8380,"Application":"XYZ University Payment API"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert duplicate key row in object 'dbo.Roles' with unique index 'IX_Roles_Name'. The duplicate key value is ().
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:f6af4d95-f7f4-490b-bd91-2e4e366b5cfe
Error Number:2601,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-07-10 11:54:54.016 +03:00 [ERR] Error creating user {"SourceContext":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3","ActionId":"3b001058-cc81-480f-925c-97653e0774e4","ActionName":"xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3.CreateUser (xyz-university-payment-api)","RequestId":"0HNDVHSKE3KHO:00000002","RequestPath":"/api/v3/user/users","ConnectionId":"0HNDVHSKE3KHO","MachineName":"DESKTOP-F3AMJ10","ThreadId":6,"ProcessId":8380,"Application":"XYZ University Payment API"}
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert duplicate key row in object 'dbo.Roles' with unique index 'IX_Roles_Name'. The duplicate key value is ().
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:f6af4d95-f7f4-490b-bd91-2e4e366b5cfe
Error Number:2601,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at xyz_university_payment_api.Presentation.Controllers.V3.UserControllerV3.CreateUser(CreateUserDto createUserDto) in C:\Users\wanja\Desktop\jj\xyz-university-payment-api\xyz-university-payment-api\Presentation\Controllers\V3\UserControllerV3.cs:line 163
2025-07-10 11:57:25.691 +03:00 [INF] Bus stopped: "rabbitmq://localhost/" {"SourceContext":"MassTransit","MachineName":"DESKTOP-F3AMJ10","ThreadId":22,"ProcessId":8380,"Application":"XYZ University Payment API"}
